<?xml version="1.0" encoding="UTF-8" standalone="no"?><beast beautitemplate='Standard' beautistatus='' namespace="beast.core:beast.evolution.alignment:beast.phylodynamics.epidemiology:beast.phylodynamics.logger:beast.phylodynamics.model:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" version="2.0">
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map>
<map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>
<tree spec="beast.util.TreeParser" id="tree" IsLabelledNewick="true" adjustTipHeights="false" trait="traitset" newick="((((((7-33_14.4133:6.0253,(((((9-92_26.3666:11.5887,(2-51_18.5065:2.3581,(2-49_18.2661:1.7854,(((((((1-139_35:10.8661,2-95_27.4655:3.3316):0.74977,(3-131_35:9.1475,(3-130_35:8.1994,1-117_34.0151:7.2145):0.94808):2.4684):4.1336,2-107_29.0605:9.81):0.1858,((3-85_24.4342:3.0471,(2-120_34.3119:11.896,2-128_35:12.5841):1.0288):1.1693,3-67_21.0249:0.80711):1.153):1.7627,1-54_19.0289:1.727):0.62781,1-114_31.9448:15.2706):0.10793,1-65_20.8184:4.2521):0.085618):0.33226):1.3705):1.6169,1-50_18.3751:5.2141):2.6318,(4-41_17.0586:6.4034,((4-25_12.8128:0.69886,1-110_29.8685:17.7545):1.1455,2-20_12.0505:1.082):0.31323):0.12611):1.0377,1-52_18.8592:9.3678):0.38873,(3-30_14.0795:2.3463,(((5-127_35:18.9503,1-75_21.9174:5.8677):2.5747,(4-64_20.7867:3.0896,((9-66_21.0142:2.9908,4-81_23.6431:5.6197):0.007618,(2-87_25.2306:6.5974,1-88_25.4807:6.8475):0.61739):0.31877):4.222):1.4101,((3-97_27.5555:14.8451,1-29_13.4634:0.75306):0.5271,((3-59_19.979:5.8882,1-84_23.8406:9.7498):1.4389,(5-68_21.0835:5.281,(2-43_17.3375:0.68898,(((4-105_29.0404:6.1586,(((4-134_35:4.7601,1-122_34.5375:4.2976):2.0161,1-126_35:6.7761):3.2001,1-116_33.613:8.5892):2.142):4.1391,((4-143_35:13.4886,3-135_35:13.4886):0.33918,(3-99_27.7343:4.6189,(1-140_35:11.7161,2-89_25.5014:2.2175):0.16848):1.9432):2.4296):1.7456,2-70_21.4881:4.491):0.34855):0.84604):3.1505):0.46873):0.11832):0.33179):2.6305):0.71469):1.0131,3-11_11.1631:3.7882):0.90838,((8-7_8.7509:0.085509,1-12_11.1799:2.5145):1.0099,(((4-13_11.3905:2.5557,(5-10_11.1317:2.0589,(((1-111_29.8875:17.2587,3-27_12.8926:0.26379):2.6287,3-45_17.6368:7.6366):0.16116,3-26_12.8738:3.0348):0.76628):0.23795):0.14027,3-18_11.9585:3.264):0.48514,(3-91_26.2926:17.1853,(5-47_18.0435:5.7726,((3-61_20.5483:4.6316,1-109_29.5046:13.5879):2.4444,(3-121_34.4951:14.6543,((8-102_28.122:4.1665,(2-108_29.2739:2.8418,1-137_35:8.5678):2.4766):3.9981,3-76_22.0703:2.1128):0.11663):6.3684):1.2015):3.1635):0.89801):0.55389):1.189):2.9301,(((((7-8_9.3894:2.8868,((((3-106_29.0458:20.242,1-28_13.275:4.4713):0.022606,((3-103_28.5193:16.5441,(((5-60_20.1514:5.2578,(3-71_21.5864:5.271,1-86_24.8443:8.5289):1.4218):1.0652,((5-96_27.5537:10.5163,1-58_19.5327:2.4952):2.0488,4-35_15.3884:0.39976):1.1603):1.7855,(2-136_35:21.573,((4-138_35:18.7372,(3-119_34.0852:17.3146,((6-62_20.6506:2.7769,1-74_21.8227:3.949):0.028547,1-46_18.0191:0.17396):1.0746):0.50773):0.20493,3-53_19.0204:2.9625):2.6308):1.3841):0.067772):0.35854,1-34_14.6801:3.0635):2.8354):1.3157,3-38_16.7411:9.2756):0.82811,(5-21_12.251:2.4921,(4-44_17.5552:7.3231,(((4-82_23.6883:8.6577,1-36_16.0802:1.0496):1.026,(2-42_17.1412:2.4348,(2-101_28.0932:11.2734,1-40_17.014:0.19416):2.1135):0.70177):2.2366,((4-104_28.7872:13.7105,((5-63_20.7534:0.62571,1-90_25.5955:5.4679):1.2145,(2-73_21.8023:2.2132,2-69_21.2224:1.6332):0.67598):3.8364):3.2217,(5-55_19.043:6.5108,((4-125_35:1.71,3-133_35:1.71):17.6827,(4-72_21.7857:4.945,2-118_34.0729:17.2322):1.2334):3.0751):0.67724):0.087064):1.5358):0.47325):3.1215):0.13475):1.3772,2-2_6.1903:1.0649):0.043026,((2-56_19.093:4.9327,2-78_22.9164:8.7561):6.2355,2-16_11.6731:3.7483):2.8424):0.032515,(((3-39_16.7832:1.5611,1-57_19.1172:3.8951):5.4486,2-23_12.499:2.7255):4.0562,((((5-48_18.2392:8.7792,(((6-100_27.7792:13.8327,2-79_23.618:9.6715):1.8469,1-112_30.9531:18.8535):2.133,2-19_12.0072:2.0406):0.50666):0.88734,2-24_12.7656:4.193):0.034347,1-129_35:26.4617):1.3191,1-32_14.1977:6.9785):1.5018):0.66751):1.4683,(((6-1_4.6841:0.2471,1-4_7.0714:2.6344):0.18284,1-37_16.2149:11.9607):0.10202,(3-6_8.5703:3.1069,((3-15_11.4652:4.61,(3-31_14.1178:0.50221,((4-94_27.0657:10.596,2-124_35:18.5303):0.20411,1-98_27.6398:11.3743):2.65):6.7603):1.103,(6-5_7.2045:0.482,1-123_35:28.2775):0.97019):0.28892):1.3113):0.57059):0.045119):0.97534,((4-14_11.4294:1.5045,((4-77_22.7226:7.8488,((3-83_23.7231:7.3151,(2-80_23.6418:3.1247,((5-113_31.3416:7.1935,(3-141_35:9.8492,1-132_35:9.8492):1.0026):1.7568,2-93_26.7331:4.3417):1.8742):4.1092):0.23174,(2-115_32.7379:4.8106,1-142_35:7.0727):11.7511):1.3024):2.9612,3-22_12.4733:0.56062):1.9878):2.9936,(2-17_11.9429:1.7808,3-9_10.4067:0.24466):3.2308):4.3702):1.4813,1-3_6.7698:5.69);"/>
<run id="mcmc" spec="MCMC" chainLength="20000">
    <state id="state" storeEvery="100">

      <!-- STATE NODES-->
		
      <stateNode spec="beast.core.parameter.RealParameter" id="epi.origin" value="35.0"/>
      <stateNode spec="beast.core.parameter.RealParameter" id="epi.dim" value="2"/>
      <stateNode spec="beast.core.parameter.RealParameter" id="epi.timeStep" value="0.1"/>
      
      <stateNode spec="beast.core.parameter.RealParameter" id="epi.nodes" value="250"/> <!-- nodes -->
      <stateNode spec="beast.core.parameter.RealParameter" id="epi.tau" value="0.25"/> <!-- transmission rate -->
      <stateNode spec="beast.core.parameter.RealParameter" id="epi.nu" value="0.1026"/> <!-- removal rate -->
      
      <stateNode spec="beast.core.parameter.RealParameter" id="epi.R0" value="1.276"/> <!-- net reproductive rate R0 -->
       
      <stateNode spec="beast.core.parameter.RealParameter" id="epi.meanK" value="2.0"/> <!-- mean of d_k -->
      <stateNode spec="beast.core.parameter.RealParameter" id="epi.varK" value="4.0"/> <!-- mean of d_k -->
      
    </state>




  <distribution id="posterior" spec="util.CompoundDistribution">
        <distribution id="prior" spec="util.CompoundDistribution">

			<distribution spec='beast.math.distributions.Prior' x="@epi.nodes">
	            <distr spec="beast.math.distributions.Uniform"  lower="200" upper="300"/>
	        </distribution>
	        
	      	<distribution spec='beast.math.distributions.Prior' x="@epi.nu">
	      		<distr spec="beast.math.distributions.LogNormalDistributionModel"  M="-2.28" S="0.1"/>
	      	</distribution>
			
			<!--         
          	<distribution spec='beast.math.distributions.Prior' x="@epi.tau">
	            <distr spec="beast.math.distributions.LogNormalDistributionModel"  M="-1.39" S="0.2"/>
	        </distribution> -->
	        
	        <distribution spec='beast.math.distributions.Prior' x="@epi.R0">
	            <distr spec="beast.math.distributions.LogNormalDistributionModel"  M="0.24" S="1.0"/>
	        </distribution>
	        
	        <!-- Other priors 
	       	<distribution spec='beast.math.distributions.Prior' x="@epi.nu">
	      		<distr spec="beast.math.distributions.Gamma"  alpha="5.0" beta="1.95"/>
	      	</distribution> -->

        </distribution>

    	<distribution id="likelihood" spec="util.CompoundDistribution">


            <!-- ARUDSIR VOLZ Likelihood-->
            <distribution id="coalescent" spec="StructCoalNetDensity" approxLambdaSum="true" ghostLineCorrection="true" minIkIl="1.0" tipStates="false" fixOriginAtRoot="false">
              <structuredTreeIntervals spec='StructuredTreeIntervals' id='TreeIntervals' tree='@tree'/>
              <epiModel spec="PairwiseEpiModel" id="SIR" maxDegree="16" isSIR="true" estimateR0="true">
                
                <!-- Specify degree distribution -->
                <degreeDist spec="GammaReparam" id="gammaDegreeDist">
                	<mean idref="epi.meanK"/>
                	<variance idref="epi.varK"/>
                </degreeDist>
                
                <R0 idref="epi.R0"/>
                <nodes idref="epi.nodes"/>
                <tau idref="epi.tau"/>
                <nu idref="epi.nu"/>
                
                <origin idref="epi.origin"/>
                <timeStep idref="epi.timeStep"/>
                
              </epiModel>
            </distribution>
        </distribution>
  
    </distribution>

  <!-- ARUDSIR Operators-->
  
	<!--   
  <operator id="tauOp" spec="ScaleOperator" scaleFactor=".9" weight="2" optimise="true" parameter="@epi.tau"/>
  <operator id="nuOp" spec="ScaleOperator" scaleFactor=".9" weight="2" optimise="true" parameter="@epi.nu"/> 
  -->
  
  <operator id="R0Op" spec="ScaleOperator" scaleFactor=".9" weight="2" optimise="true" parameter="@epi.R0"/>
  <operator id="meanKOp" spec="ScaleOperator" scaleFactor=".9" weight="2" optimise="true" parameter="@epi.meanK"/>
  <operator id="varKOp" spec="ScaleOperator" scaleFactor=".9" weight="2" optimise="true" parameter="@epi.varK"/>
  <operator id='upDownMeanVarOp' spec='UpDownOperator' scaleFactor="0.9" weight="4" optimise="true">
         <up idref="epi.meanK"/>
         <down idref="epi.varK"/>
  </operator>
  <operator id='upDownR0Op' spec='UpDownOperator' scaleFactor="0.9" weight="6" optimise="true">
         <up idref="epi.meanK"/>
         <up idref="epi.varK"/>
         <down idref="epi.R0"/>
  </operator>
   
    <logger id="tracelog" fileName="PairTreeTest_HIV_contHet_meanVar_simTree1.log" logEvery="10" model="@posterior" sanitiseHeaders="true" sort="smart">
      <log idref="posterior"/>
      <log idref="coalescent"/>
      <log idref="prior"/>
      <log idref="epi.R0"/>
      <log idref="epi.nu"/>
      <log idref="epi.meanK"/>
      <log idref="epi.varK"/>
      <log idref="SIR"/>
    </logger>
    <logger id="screenlog" logEvery="10">
      <log idref="posterior"/>
      <log idref="coalescent"/>
      <log idref="prior"/>
      <log idref="epi.R0"/>
      <log idref="epi.nu"/>
      <log idref="epi.meanK"/>
      <log idref="epi.varK"/>
      <log idref="SIR"/>
    </logger>
    <!--  
  <logger id="probtreelog.t:MSABahlData4" fileName="Rate_1e3_Mb_symmetric_S3_100_100_arudsir.trees" logEvery="1000" mode="tree">
    <log id="PropTreeWithMetaDataLogger.t:MSABahlData4" spec="StructuredTreeLogger" tree="@tree" volzDensity="@coalescent" maxState="false"/>
  </logger> -->
</run>
</beast>
